!function(){"use strict";angular.module("lostProperty").component("lostPropertyApp",{templateUrl:"/app/lost-property-app.component.html",$routeConfig:[{path:"/find",component:"find",name:"Find"},{path:"/home",component:"home",name:"Home"},{path:"/place",component:"place",name:"Place"},{path:"/place/:id",component:"place",name:"EditPlace"},{path:"/list-categories",component:"listCategories",name:"ListCategories"},{path:"/add-category",component:"addCategory",name:"AddCategory"},{path:"/detail/:id/...",component:"movieDetails",name:"Details"},{path:"/login",component:"login",name:"Login"},{path:"/register",component:"register",name:"Register"},{path:"/**",redirectTo:["Home"]}],controllerAs:"model",controller:["authentication","$rootRouter",function(a,b){var c=this;c.isLoggedIn=function(){return!!a.isLoggedIn()},c.getLoggedInUser=function(){return a.currentUser()},c.logout=function(){a.logout(),b.navigate(["Home"])},c.isAdminUser=function(){var a=this.getLoggedInUser();return null!=a&&1==a.admin}}]})}(),function(){"use strict";angular.module("lostProperty").component("home",{templateUrl:"/app/home.component.html"})}(),function(){"use strict";function a(a,b){var c=function(a){b.localStorage.setItem("lostproperty-token",a)},d=function(){return b.localStorage.getItem("lostproperty-token")},e=function(){b.localStorage.removeItem("lostproperty-token")},f=function(b){return a.post("/api/register",b).then(function(a){return a.data.token&&c(a.data.token),a.data})},g=function(b){return a.post("/api/login",b).then(function(a){return a.data.token&&c(a.data.token),a.data},function(a){return"401"==a.status?{errorMessage:"User or Password incorrect"}:{errorMessage:"System error occured"}})},h=function(){var a,c=d();return!!c&&(a=c.split(".")[1],a=b.atob(a),a=JSON.parse(a),a.exp>Date.now()/1e3)};return{isLoggedIn:h,saveToken:c,getToken:d,logout:e,register:f,login:g,logout:e,currentUser:function(){if(h()){var a=d(),c=a.split(".")[1];return c=b.atob(c),c=JSON.parse(c),{email:c.email,name:c.name,admin:c.admin}}}}}angular.module("lostProperty").service("authentication",a),a.$inject=["$http","$window"]}(),function(){"use strict";angular.module("lostProperty").component("login",{templateUrl:"/app/login.component.html",controllerAs:"model",controller:["$http","authentication","toaster","$rootRouter",function(a,b,c,d){var e=this;e.credentials={email:"",password:""},e.login=function(){e.credentials.email=e.email,e.credentials.password=e.password,b.login(e.credentials).then(function(a){a.token?(d.navigate(["Home"]),c.pop("success","Result","Login Successful")):a.errorMessage&&c.pop("error","Result",a.errorMessage)})}}]})}(),function(){"use strict";angular.module("lostProperty").component("register",{templateUrl:"/app/register.component.html",controllerAs:"model",controller:["$http","authentication","$rootRouter","toaster",function(a,b,c,d){var e=this;e.register=function(a){var f={name:e.name,email:e.email,password:e.password};b.register(f).then(function(a){a.token?(c.navigate(["Home"]),d.pop("success","Result","Registration Successful")):a.errorMessage&&d.pop("error","Result",a.errorMessage)})}}]})}(),function(){"use strict";angular.module("lostProperty").component("find",{templateUrl:"/app/find.component.html",controllerAs:"model",controller:["$http","authentication",function(a,b){var c=this;c.categories=[],c.items=[],c.itemPage,c.itemPages,c.pageSize=5,c.datePicker={opened:!1},c.openDatePicker=function(){c.datePicker.opened=!0},c.isLoggedIn=function(){return!!b.isLoggedIn()},c.getLoggedInUser=function(){return b.currentUser()},c.isAdminUser=function(){var a=this.getLoggedInUser();return null!=a&&1==a.admin},c.searchModel={itemName:null,itemCategory:null,itemDate:null},c.search=function(b){a.post("/api/findItem",{data:c.searchModel}).then(function(a){c.items=a.data,c.itemPage=c.items.slice(0,c.items.length<c.pageSize?c.items.length:c.pageSize),c.itemPages=Math.ceil(c.items.length/c.pageSize)},function(a){})},c.loadCategories=function(){a.get("/api/category").then(function(a){c.categories=a.data},function(a){})},this.$onInit=function(){c.loadCategories()}}]})}(),function(){"use strict";angular.module("lostProperty").component("place",{templateUrl:"/app/place.component.html",controllerAs:"model",controller:["$http","toaster","authentication",function(a,b,c){var d=this;d.showDeleteButton=!1,d.showFoundButton=!1,d.showUpdateButton=!1,d.showSaveButton=!1,d.categories=[],d.datePicker={opened:!1},d.openDatePicker=function(){d.datePicker.opened=!0},d.loadCategories=function(){a.get("/api/category",{headers:{Authorization:"Bearer "+c.getToken()}}).then(function(a){d.categories=a.data},function(a){})},d.deleteItem=function(){b.pop("warning","Hi ","{template: 'confirmDeleteTmpl.html', data: 'MyData'}",15e3,"templateWithData")},d.deleteItemConfirmed=function(){a.post("/api/deleteItem?id="+d._id,d,{headers:{Authorization:"Bearer "+c.getToken()}}).then(function(a){console.log("response",a.data),"ok"==a.data.status&&(b.pop("success","Result","Item has been deleted."),d.showFoundButton=!1,d.showUpdateButton=!1,d.showDeleteButton=!1)},function(a){})},d.itemLocated=function(){a.post("/api/itemLocated?id="+d._id,d,{headers:{Authorization:"Bearer "+c.getToken()}}).then(function(a){console.log("response",a.data),"ok"==a.data.status&&(b.pop("success","Result","Item successfully marked as having been found."),d.showFoundButton=!1,d.located=!0)},function(a){})},d.updateItem=function(){console.log("update Item"),a.post("/api/updateItem",d,{headers:{Authorization:"Bearer "+c.getToken()}}).then(function(a){console.log("response",a.data),"ok"==a.data.status&&b.pop("success","Result","Item Updated.")},function(a){})},d.saveItem=function(){console.log("save Item"),a.post("/api/place",d,{headers:{Authorization:"Bearer "+c.getToken()}}).then(function(a){console.log("response",a.data),"ok"==a.data.status&&(b.pop("success","Result","Item Saved."),d.showSaveButton=!1,d.showFoundButton=!0,d.showUpdateButton=!0,d.showDeleteButton=!0)},function(a){})},d.$onInit=function(){d.loadCategories()},d.$routerOnActivate=function(b){var e=b.params.id;e?a.get("/api/place?id="+e,{headers:{Authorization:"Bearer "+c.getToken()}}).then(function(a){d._id=a.data._id,d.itemDate=new Date(a.data.itemDate),d.itemLocation=a.data.itemLocation,d.itemDescription=a.data.itemDescription,d.itemLostOrFound=a.data.itemLostOrFound,d.itemName=a.data.itemName,d.itemTime=a.data.itemTime,d.itemCategory=a.data.itemCategory,d.located=a.data.located,d.showSaveButton=!1,0==d.located&&(d.showFoundButton=!0),d.showUpdateButton=!0,d.showDeleteButton=!0},function(a){}):d.showSaveButton=!0}}]})}(),function(){"use strict";angular.module("lostProperty").component("addCategory",{templateUrl:"/app/add-category.component.html",controllerAs:"model",controller:["$http","$rootRouter","toaster","authentication",function(a,b,c,d){var e=this;e.saveCategory=function(){console.log("tom"),a.post("/api/category",e,{headers:{Authorization:"Bearer "+d.getToken()}}).then(function(a){console.log("response",a.data),"ok"==a.data.status?(b.navigate(["ListCategories"]),c.pop("success","Result","Category Saved.")):c.pop("error","Result","Category already exists.")},function(a){})}}]})}(),function(){"use strict";angular.module("lostProperty").component("listCategories",{templateUrl:"/app/list-categories.component.html",controllerAs:"model",controller:["$http","authentication",function(a,b){var c=this;c.categories=[],c.pageSize=5,c.currentPage=0,c.categoryPage=[],c.categoryPages=0,c.nextPage=function(){if(c.hasNext()){var a=(c.currentPage+1)*c.pageSize,b=(c.currentPage+2)*c.pageSize>c.categories.length?c.categories.length:(c.currentPage+2)*c.pageSize;c.categoryPage=c.categories.slice(a,b),c.currentPage+=1}},c.previousPage=function(){if(c.hasPrevious()){var a=null,b=null;1==c.currentPage?(a=0,b=c.currentPage*c.pageSize):(a=(c.currentPage-1)*c.pageSize,b=c.currentPage*c.pageSize),c.categoryPage=c.categories.slice(a,b),c.currentPage-=1}},c.gotoPage=function(a){var b=a*c.pageSize,d=(a+1)*c.pageSize;c.categoryPage=c.categories.slice(b,d),c.currentPage=a},c.hasNext=function(){return(c.currentPage+1)*c.pageSize<c.categories.length},c.hasPrevious=function(){return c.currentPage>0},c.getCategoryPages=function(){return new Array(c.categoryPages)},this.$onInit=function(){c.listCategories()},c.listCategories=function(){a.get("/api/category",{headers:{Authorization:"Bearer "+b.getToken()}}).then(function(a){c.categories=a.data,c.categoryPage=c.categories.slice(0,c.categories.length<c.pageSize?c.categories.length:c.pageSize),c.categoryPages=Math.ceil(c.categories.length/c.pageSize)},function(a){})}}]})}();